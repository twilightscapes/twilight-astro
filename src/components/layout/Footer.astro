---
import { getCollection } from "astro:content"; // Changed this line

// Get footer menu items from separate collection
let menuLinks: Array<any> = [];
try {
  menuLinks = (await getCollection("footerMenuItems")) || [];
} catch (error) {
  // Collection doesn't exist or is empty
  menuLinks = [];
}

const sortedMenuLinks = menuLinks
	.sort((a, b) => (a.data.order || 0) - (b.data.order || 0))
	.map((item) => ({
		title: item.data.title || "",
		path: item.data.path || "",
	}));

const year = new Date().getFullYear();
import { getEntry } from "astro:content";
const siteSettings = await getEntry("siteSettings", "main");
const { showHome } = siteSettings?.data || { showHome: true };
const language = await getEntry("language", "index");
const copyright = language?.data?.copyright || "Â©";
const homelink = language?.data?.homelink || "Home";
const pwaSettings = await getEntry("pwaSettings", "index");
const appName = pwaSettings?.data?.name || "App";
---

<footer
	id="footer"
	class="text-white-500 mt-auto flex w-full flex-col items-center justify-center gap-y-2 p-4 text-center align-top sm:flex-row sm:justify-between sm:text-xs"
>
	<div class="me-0 sm:me-4">
		{copyright}
		{year}{" "}
		{appName}
	</div>
	<nav aria-label="Menu" class="flex gap-x-2 sm:gap-x-0 sm:divide-x sm:divide-gray-500">
		{
			sortedMenuLinks.map((link: { path: string | null; title: string }) => (
				<a
					href={link.path + "/" || "#"}
					class="px-1 py-2 sm:px-2 sm:py-0 sm:hover:text-textColor sm:hover:underline"
					style="color:inherit"
					aria-label={link.title || "Menu link"}
				>
					{link.title || "Menu"}
				</a>
			))
		}
	</nav>
</footer>
